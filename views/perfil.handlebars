<div class="container-fluid">
  {{> buscador }}
  <div class="biombo row">
    <div class="responsivo mt-1 mb-1 col-5 rounded-start" style="background: green">

      {{> cardUsuario }}
      <div class="container col-5 text-center">
        <h2 class="text-center py-5">Ultimos movimientos</h2>


        <div id="movimientos" class="d-flex justify-content-between">
          <div>
            <a class="btn btn-primary mx-auto" href="./transacciones">Transacciones</a>
          </div>
          <div>
            <a class="btn btn-danger mx-auto" href="./notificacion">Notificaciones</a>
          </div>
        </div>

      </div>

    </div>

    <div class="responsivo col-7 mt-1 mb-1 py-5 text-center rounded-end" style="background: green;">
      <h1 style="color: aliceblue;">Hola {{this.nombre}}!!</h1>
      <h2>Tu perfil</h2>
      <br>
    <form action="/actualizar/{{this.email}}?_method=PUT" method="POST" enctype="multipart/form-data">
    <input type="hidden" name="_method" value="PUT">
        <div class="form-group">
          <div class="form-group">
            <label for="nombre">Nombre</label><br>
            <input type="text" name="nombre" disabled placeholder="Ana Torres" class="form-control w-50 m-auto"
              value="{{this.nombre}}">
          </div>
          <div class="form-group pt-4">
            <label for="nombre">Cedula de identidad</label><br>
            <input type="text" name="rut" disabled placeholder="15123123-8" class="form-control w-50 m-auto"
              value="{{this.rut}}">
          </div>
          <div class="form-group pt-4">
            <label for="nombre">Email</label><br>
            <input type="text"  name="email"disabled placeholder="ejemplo@gmail.com" class="form-control w-50 m-auto"
              value="{{this.email}}">
          </div>
         <div class="form-group pt-4">
    <label for="nombre">Telefono</label><br>
    <input type="text" name="telefono" placeholder="569111111" class="form-control w-50 m-auto"
      value="{{this.telefono}}">
  </div>
          <div class="form-group py-4">
            <label for="nombre">Sector</label><br>
            <input type="text" name="sector" disabled placeholder="Providencia" class="form-control w-50 m-auto"
              value="{{this.nombre_sector}}">
          </div>
          <div class="form-group pt-4">
            <label for="nombre">Password</label><br>
            <input type="password" disabled name="password" placeholder="*********" class="form-control w-50 m-auto"
              value="{{this.password}}">
          </div>
          <div class="form-group pt-4">
            <label for="nombre">Repite password</label><br>
            <input type="password" disabled name="repite_pasword" placeholder="***********" class="form-control w-50 m-auto"
              value="{{this.repite_password}}">
          </div>                    
        </div>

          {{!-- comentado por mientras --}}

        {{!-- <label for="comuna">Comuna/Sector</label><br>
        <select class="form-select mb-3 w-50 m-auto" name="sector" aria-label="Default select example">
          <option selected>Selecciona una comuna</option>
          <option value="Ñuñoa">Ñuñoa</option>
          <option value="Providencia">Providencia</option>
          <option value="Estación Central">Estación Central</option>
          <option value="Santiago Centro">Santiago Centro</option>
          <option value="Las Condes">Las Condes</option>
        </select> --}}

        <div class="form-group col-12 col-sm-12">
          <p class="text-white pb-3">Sube tu foto de perfil</p><br>
          <input type="file" name="foto" onchange="previewFile()"><br>
        </div>
        <div>
          <input class="btn btn-primary my-3 py- w-50 m-auto" type="submit" value="modificar" onClick="modificar()">
          
          {{!-- <button type="submit" class="btn btn-primary my-3 pt-2 w-50 m-auto" >Modificar</button><br> --}}
        </div>
      </form>

      <div>
        <form>
          <td><button class="btn btn-primary m-auto" type="button" onclick="enviar('{{this.id}}')">Eliminar usuario</button></td> 
        </form>      
      </div>


      <p><a class="nav-link" href="./inventario">Gestiona tu inventario</a></p>

    </div>
  </div>

  <section>
    <h1 class="text-center mt-5" style="color: green;">Tu inventario</h1>
    <div class="py-4">
      <hr class="w-100" />

      <table class="table w-80 m-auto rounded" style="background: green; height: 60px">
        <thead>
          <tr>
            {{!-- <th scope="col">#</th> --}}
            <th scope="col">Foto</th>
            <th scope="col">Marca</th>
            <th scope="col">Nombre</th>
            <th scope="col">Precio</th>
            <th scope="col">Stock</th>
            <th scope="col">Descripción</th>
          </tr>
        </thead>

        <tbody>
          {{#each productos}}
          <tr>
            {{!-- <td>{{@index}}</td> --}}
            <td>
              <div>
                <img class="rounded-circle" src="/uploads/{{this.nombrep}}.jpg" onerror="this.onerror=null;this.parentNode.innerHTML='<a href=\'https://www.google.com/search?q={{this.nombrep}} {{this.marca}}&source=lnms&tbm=isch\' target=\'_blank\'>Intenta verlo por acá</a>';" height="55" width="75">
                {{!-- <img class="rounded-circle" src="/uploads/{{this.nombrep}}.jpg" height="55" Width="75"> --}}
              </div>
            </td>

            {{!-- <td>Perfume Pitanga</td>
            <td>54.990</td>
            <td>18</td>
            <td>Masculino</td> --}}
            <td>{{this.marca}}</td>
            <td>{{this.nombrep}}</td>
            <td>{{this.precio}}</td>         
            <td>{{this.cantidad}}</td>
            <td>{{this.cliente}}</td>            
            <td><button class="btn btn-primary m-auto" type="button" onclick="enviar('{{this.id}}')">Eliminar</button></td>           
            {{!-- <td><a class="btn btn-primary mb-4 py-2 w-40 m-auto" href="./elimina_producto/:{{this.id}}">Eliminar</a></td> --}}
          </tr>
          {{/each}} 
        </tbody>
      </table>
      <div class="text-center mt-3">
        <th><a class="btn btn-primary" style="margin: 20px" href="cerrar-sesion" role="button">Cerrar sesion</a></th>
      </div>
    </div>
  </section>
</div>

<script>

  function previewFile() {
    const preview = document.getElementById('ppUsuario');
    const file = document.querySelector('input[type=file').files[0];
    const reader = new FileReader();

    reader.addEventListener("load", () => {
      preview.src = reader.result;
    }, false);

    if (file) {
      reader.readAsDataURL(file);
    }
  }

</script>

<script>
function enviar(id) {
  var objeto = {
    id: id     
  };
  fetch('/enviar-objeto2', {
    method: 'DELETE',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify(objeto)
  })
  .then(function(response) {
    // Hacer algo con la respuesta del servidor si lo deseas
  })
  .catch(function(error) {
    console.error(error);
  });
}

</script>

<script>
function enviar(id) {
  var objeto = {
    id: id     
  };
  fetch('/enviar-objeto3', {
    method: 'PUT',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify(objeto)
  })
  .then(function(response) {
    // Hacer algo con la respuesta del servidor si lo deseas
  })
  .catch(function(error) {
    console.error(error);
  });
}

</script>

{{!-- <script>
function enviar(id) {
  var objeto = {
    id: id     
  };
  fetch('/enviar-objeto4', {
    method: 'PUT',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify(objeto)
  })
  .then(function(response) {
    // Hacer algo con la respuesta del servidor si lo deseas
  })
  .catch(function(error) {
    console.error(error);
  });
}

</script>
 --}}
