<div class="container-fluid">
  {{!-- {{> navbarUsuario ESTA ES EL NAVBAR QUE LE CORRESPONDE, PERO MIENTRAS DESARROLLAMOS ESTARA COMENTADO POR COMODIDAD PARA LAS PRUEBAS}} --}}
  {{> buscador }}  
  <div class="biombo row">    
    <div class="responsivo mt-1 mb-1 col-5 rounded-start" style="background: green"> 
      {{> cardUsuario }}
      {{!-- <h2 class="text-center py-5">Usuaria activa</h2> 
      <h4 class="text-center">Responde a tiempo</h4>      --}}
    </div>    

    <div class="responsivo col-7 mt-1 mb-1 py-5 text-center rounded-end" style="background: green;">
      <h1 style="color: aliceblue;">{{this.nombre}}!!</h1>      
      <h2>Completa tu perfil</h2>
      <br>


<form action="/perfil" method="GET" enctype="multipart/form-data">      
    
  <div class="form-group">
    <div class="form-group"> 
      <label for="nombre">Nombre</label><br>              
      <input type="text"  name="nombre" placeholder="Ana Torres" class="form-control w-50 m-auto" value="{{#if this.nombre}}{{this.nombre}}{{/if}}" />
    </div>          
    <div class="form-group pt-4">
      <label for="nombre">Email</label><br>         
      <input type="text" name="email" placeholder="no funciona" class="form-control w-50 m-auto" value="{{#if this.email}}{{this.email}}{{/if}}">
    </div>     
    <div class="form-group pt-4">
      <label for="nombre">Password</label><br>         
      <input type="password" name="password" placeholder="*********" class="form-control w-50 m-auto" value="{{#if this.contraseña}}{{this.contraseña}}{{/if}}">
    </div>          
    <div class="form-group pt-4"> 
      <label for="nombre">Repite password</label><br>        
      <input type="password" name="repita_pasword" placeholder="***********" class="form-control w-50 m-auto" value="{{#if this.contraseña}}{{this.contraseña}}{{/if}}">
    </div>
    <div class="form-group pt-5"> 
      <label for="nombre">Telefono</label><br>       
      <input type="text" name="telefono" placeholder="56999999999" class="form-control w-50 m-auto" value="{{#if this.telefono}}{{this.telefono}}{{/if}}" />
    </div>
    <div class="form-group py-4">
      <label for="nombre">Direccion</label><br>         
      <input type="text" name="direccion" placeholder="calle las maravillas 456" class="form-control w-50 m-auto" value="{{#if this.direccion}}{{this.direccion}}{{/if}}">
    </div>         
  </div>

<label for="comuna">Comuna/Sector</label><br>
<select class="form-select mb-3 w-50 m-auto" name="comuna" aria-label="Default select example">
    <option selected>Selecciona una comuna</option>
    <option value="Ñuñoa">Ñuñoa</option>
    <option value="Providencia">Providencia</option>
    <option value="Estación Central">Estación Central</option>
    <option value="Santiago Centro">Santiago Centro</option>
    <option value="Las Condes">Las Condes</option>
</select>





        <div class="form-group col-12 col-sm-12">
          <p class="text-white pb-3">Sube tu foto de perfil</p><br>            
          <input type="file" name="foto" onchange="previewFile()"><br>          
        </div>

        <button class="btn btn-primary my-3 py- w-50 m-auto">Modificar</button>
        <button class="btn btn-danger my-3 py- w-50 m-auto">Eliminar</button>
      </form>

      {{#if this._id}}
        <script>
          document.querySelector('button.btn-danger').addEventListener('click', function(e) {
            e.preventDefault(); 
          });
        </script>
      {{/if}}

    </div>
  </div>

  <section>
    <h1 class="text-center mt-5" style="color: green;">Tu inventario</h1>
    <div class="py-4">  
  <hr class="w-100"/>

  <table class="table w-80 m-auto rounded" style="background: green; height: 60px">
    <thead>
      <tr>
        <th scope="col">#</th>
        <th scope="col">Foto</th>
        <th scope="col">Nombre</th>        
        <th scope="col">Precio</th>
        <th scope="col">Stock</th>
        <th scope="col">Descripción</th>                     
      </tr>
    </thead>

    <tbody> 
           
      {{#each productos}}
      <tr>
        <td>{{@index}}</td>
        <td>
          <div>                
            <img class="rounded-circle" src="../public/uploads/humor.jpeg" height="55" Width="75">                
          </div>
        </td>
        <td>{{this.nombre}}<br>{{this.precio}}<br>{{this.stock}}<br>{{this.descripcion}}<br></td>

        <th><a class="btn btn-primary" style="margin: 20px" href="inicio" role="button">Inicia sesión</a></th>   
               
        {{!-- <td><input type="radio" name="seleccion" {{#if false }} checked {{/if}} onclick="autorizar({{this.d}}, this)"></td>    --}}
        
      </tr>  
      {{/each}} 
      
    </tbody>
  </table>
  <div class="text-center mt-3">    
    <a  href="./">Página principal</a>
  </div>
    
</div>


<script>

  const autorizar = async (cedula_de_identidad, e) => {    
    const seleccion = e.checked
    console.log(cedula_de_identidad, seleccion);
    try {
      await axios.put('/seleccion_especialista', {
        cedula_de_identidad,
        seleccion
      })
      alert(seleccion ? 'Especialista seleccionado, por favor confirme seleccion' : 'Ha ocurrido un error, intente más tarde');      
    }
    catch ({ respuesta }) {
      const { data } = respuesta
      const { error } = data
      alert(error)
    }    
  }
  
</script>  

  </section>
</div>

<script>

  function previewFile() {
    const preview = document.getElementById('pw');
    const file = document.querySelector('input[type=file').files[0];
    const reader = new FileReader();

    reader.addEventListener("load", () => {
      preview.src = reader.result;
    }, false);

    if (file) {
      reader.readAsDataURL(file);
    }
  }
  
</script>


